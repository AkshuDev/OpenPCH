#:kivy 2.3.0
#:import rgba kivy.utils.get_color_from_hex
#:import dp kivy.metrics.dp

<ScifiSlider@Slider>:
    # remove default graphics
    background_color: (0.0, 0.0, 0.0, 0.0)
    cursor_image: ''
   
    # Hide defalt knob
    cursor_size: (0,0)
    # Kill Kivy's default fill bar
    value_track: False
    value_track_color: 0, 0, 0, 0

    size_hint_y: None
    
    canvas.before:
        Color: 
            rgba: 0.0, 1.0, 0.8, 0.8
        RoundedRectangle:
            size: self.width, 4
            pos: self.x, self.center_y - 3
            radius: [dp(5)]

    canvas.after:
        # Knob (scifi circle)
        Color:
            rgba: 0.0, 1.0, 0.8, 0.8
        Ellipse:
            size: 24,24
            pos: self.value_pos[0] - 12, self.center_y - 12

        # glow
        Color:
            rgba: 0.0, 1.0, 0.8, 0.6
        Ellipse:
            size: 40,40
            pos: self.value_pos[0] - 20, self.center_y - 20

<NeonButton@Button>:
    font_size: '16sp'
    background_normal: ''
    background_color: 0.0, 0.0, 0.0, 0.0
    color: rgba('#33ccffff')
    canvas.before:
        Color:
            rgba: (*rgba('#002233')[:3], 0.9) if self.state == 'normal' else rgba('#005577AA')
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [dp(25)]
        Color:
            rgba: rgba('#33ccff22')
        Line:
            width: 1.5
            rounded_rectangle: (self.x, self.y, self.width, self.height, dp(25))
    on_press:
        background_color = rgba('#005577AA')
    on_release:
        background_color = rgba('#002233AA')

<LabelGlow@Label>:
    font_size: '14sp'
    color: (*rgba('#33ccff')[:3], 0.9)
    canvas.before:
        Color:
            rgba: rgba('#33ccff22')
        Line:
            width: 1
            rounded_rectangle: (self.x - dp(2), self.y - dp(2), self.width + dp(4), self.height + dp(4), dp(50))

ScreenManager:
    MainScreen:

<MainScreen>:
    name: 'main'
    canvas.before:
        Color:
            rgba: (*rgba('#0f111a')[:3], 0.8)
        Rectangle:
            pos: self.pos
            size: self.size

    GridLayout:
        cols: 2
        padding: dp(20)
        spacing: dp(20)

        # Left: Mouse Visual + Quick Stats
        BoxLayout:
            orientation: 'vertical'
            padding: dp(10)
            spacing: dp(10)
            canvas.before:
                Color:
                    rgba: rgba('#1a1c2a')
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [dp(10)]
            Label:
                text: '[b]Device:[/b] ' + (root.selected_device.name if root.selected_device else "None")
                markup: True
                italic: True
                halign: 'left'
                size_hint_y: None
                height: dp(30)
                color: rgba('#33ccffff')
            # Placeholder for graphical device representation
            Label:
                text: 'ðŸ–±'
                font_size: '120sp'
                size_hint_y: None
                height: dp(140)
                color: rgba('#33ccffff')

        # Right: Controls Panel
        BoxLayout:
            orientation: 'vertical'
            spacing: dp(20)
            padding: dp(10)
            canvas.before:
                Color:
                    rgba: rgba('#1a1c2a')
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [dp(10)]

            LabelGlow:
                text: 'DPI'
            ScifiSlider:
                min: 200
                max: 16000
                value: root.dpi
                on_value: root.dpi = self.value
                cursor_image: ''  # Custom cursor if desired
            Label:
                text: str(int(root.dpi))
                font_size: '18sp'
                color: rgba('#33ccffff')
                size_hint_y: None
                height: dp(30)

            LabelGlow:
                text: 'RGB Color'
            # Simplify color wheel to brightness slider for minimal design
            ScifiSlider:
                min: 0
                max: 1
                value: root.rgb_color[0]
                on_value: root.rgb_color = [self.value, self.value, self.value, 1]
                cursor_image: ''

            BoxLayout:
                size_hint_y: None
                height: dp(50)
                spacing: dp(10)
                NeonButton:
                    text: root.connected and 'Disconnect' or 'Connect'
                    on_release: root.toggle_connect()
                NeonButton:
                    text: 'Save Profile'
                    on_release: root.save_profile()
                NeonButton:
                    text: 'Export'
                    on_release: root.export_profile_json()
